<div class="min-h-screen bg-white flex font-sans antialiased text-slate-900">

  <div class="flex-1 flex flex-col justify-center px-8 sm:px-12 md:px-20 lg:px-24 xl:px-32 py-12">

    <div class="mb-10 flex items-center gap-2.5">
      <div
        class="w-9 h-9 bg-indigo-600 rounded-md flex items-center justify-center text-white shadow-lg shadow-indigo-100">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/>
        </svg>
      </div>
      <span class="text-xl font-bold tracking-tight">ChatStream</span>
    </div>

    <div class="max-w-xl w-full">
      <h2 class="text-3xl font-bold text-slate-900 mb-2">Create your account</h2>
      <p class="text-slate-500 mb-8 font-medium">Start your 14-day free trial. No credit card required.</p>

      <form class="space-y-5" [formGroup]="registerForm" (ngSubmit)="onRegister()">

        <div *ngIf="_notificationService.message$ | async as message">
          <chat-notification [message]="message"/>
        </div>

        <div class="flex flex-col items-center gap-3">
          <div class="relative">
            <img
              [src]="imagePreview || 'https://ui-avatars.com/api/?name=User&background=EEF2FF&color=4F46E5&size=128'"
              class="w-28 h-28 rounded-full object-cover border-2 border-dashed border-indigo-200 p-1"
              alt="Profile Preview"
            />
            <label
              class="absolute h-9 w-9 bottom-0 right-0 bg-indigo-600 text-white rounded-full cursor-pointer hover:bg-indigo-700 flex justify-center items-center shadow-lg transition-transform active:scale-90">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24"
                   stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
              <input type="file" accept="image/*" class="hidden" (change)="onImageSelected($event)"/>
            </label>
          </div>
          <p class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Profile Picture</p>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="space-y-1.5">
            <label class="text-sm font-semibold text-slate-700">First Name</label>
            <div class="relative group">
              <span
                class="absolute inset-y-0 left-0 pl-3 flex items-center text-slate-400 group-focus-within:text-indigo-600 pointer-events-none">
                <i class="fa-regular fa-user text-xs"></i>
              </span>
              <input type="text" placeholder="John" formControlName="firstname"/>
            </div>
            <chat-form-error [control]="firstname"/>
          </div>

          <div class="space-y-1.5">
            <label class="text-sm font-semibold text-slate-700">Last Name</label>
            <div class="relative group">
              <span
                class="absolute inset-y-0 left-0 pl-3 flex items-center text-slate-400 group-focus-within:text-indigo-600 pointer-events-none">
                <i class="fa-regular fa-user text-xs"></i>
              </span>
              <input type="text" placeholder="Doe" formControlName="lastname"/>
            </div>
            <chat-form-error [control]="lastname"/>
          </div>
        </div>

        <div class="space-y-1.5">
          <label class="text-sm font-semibold text-slate-700">Email Address</label>
          <div class="relative group">
            <span
              class="absolute inset-y-0 left-0 pl-3.5 flex items-center text-slate-400 group-focus-within:text-indigo-600 pointer-events-none">
              <i class="fa-regular fa-envelope text-xs"></i>
            </span>
            <input type="email" placeholder="john@company.com" formControlName="email"/>
          </div>
          <chat-form-error [control]="control('email')"/>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="space-y-1.5">
            <label class="text-sm font-semibold text-slate-700">Password</label>
            <div class="relative group">
              <span
                class="absolute inset-y-0 left-0 pl-3.5 flex items-center text-slate-400 group-focus-within:text-indigo-600 pointer-events-none">
                <i class="fa-solid fa-lock text-xs"></i>
              </span>
              <input [type]="showPassword ? 'text' : 'password'" placeholder="••••••••" formControlName="password"/>
              <button (click)="togglePasswordVisibility('pass')" type="button"
                      class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-indigo-600">
                <i class="fa-solid" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
              </button>
            </div>
            <chat-form-error [control]="control('password')"/>
          </div>

          <div class="space-y-1.5">
            <label class="text-sm font-semibold text-slate-700">Confirm Password</label>
            <div class="relative group">
              <span
                class="absolute inset-y-0 left-0 pl-3.5 flex items-center text-slate-400 group-focus-within:text-indigo-600 pointer-events-none">
                <i class="fa-solid fa-shield-halved text-xs"></i>
              </span>
              <input [type]="showConfirmPassword ? 'text' : 'password'" placeholder="••••••••"
                     formControlName="confirmPassword"/>
              <button (click)="togglePasswordVisibility('confirm')" type="button"
                      class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-indigo-600">
                <i class="fa-solid" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
              </button>
            </div>
            <chat-form-error [parentForm]="registerForm" formErrorKey="mismatch"
                             [displayTriggerControl]="registerForm.get('confirmPassword')"/>
          </div>
        </div>

        <button type="submit" [disabled]="loading"
                class="w-full py-4 bg-slate-900 hover:bg-black text-white font-bold rounded-xl shadow-xl shadow-slate-200 transition-all transform active:scale-[0.98] flex items-center justify-center gap-2 mt-4 disabled:opacity-70 disabled:cursor-not-allowed">
          <span *ngIf="!loading">Create Account</span>
          <div *ngIf="loading" class="flex items-center gap-2">
            <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none"
                 viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span>Processing...</span>
          </div>
          <svg *ngIf="!loading" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24"
               stroke="currentColor" stroke-width="2.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M14 5l7 7m0 0l-7 7m7-7H3"/>
          </svg>
        </button>
      </form>

      <div class="mt-8 text-center text-sm">
        <span class="text-slate-500 font-medium">Already have an account?</span>
        <a routerLink="/login"
           class="ml-1.5 font-bold text-indigo-600 hover:text-indigo-700 transition-colors cursor-pointer">Sign in
          here</a>
      </div>
    </div>
  </div>

  <div
    class="hidden lg:flex flex-1 bg-slate-50 items-center justify-center p-12 border-l border-slate-100 relative overflow-hidden">
    <div class="max-w-md w-full text-center relative z-10">
      <div class="relative mb-12">
        <div class="bg-white p-8 rounded-[2.5rem] shadow-2xl shadow-slate-200 border border-white relative z-10">
          <div class="flex items-center gap-3 mb-6">
            <div class="w-10 h-10 rounded-full bg-indigo-600"></div>
            <div class="space-y-2 flex-1 text-left">
              <div class="h-3 w-1/3 bg-slate-100 rounded-full"></div>
              <div class="h-2 w-1/2 bg-slate-50 rounded-full"></div>
            </div>
          </div>
          <div class="space-y-3">
            <div class="h-3 w-full bg-indigo-50 rounded-full"></div>
            <div class="h-3 w-full bg-indigo-50 rounded-full"></div>
            <div class="h-3 w-2/3 bg-slate-50 rounded-full"></div>
          </div>
        </div>
        <div
          class="absolute -top-12 -right-12 w-40 h-40 bg-indigo-200 rounded-full blur-3xl opacity-40 animate-pulse"></div>
        <div
          class="absolute -bottom-12 -left-12 w-40 h-40 bg-blue-100 rounded-full blur-3xl opacity-40 animate-pulse"></div>
      </div>
      <h3 class="text-2xl font-bold text-slate-900 leading-snug">The foundation for <br/> high-performance teams.</h3>
      <p class="text-slate-500 mt-4 leading-relaxed font-medium">Join 10k+ businesses scaling their communication with
        ChatStream's ultra-fast interface.</p>
    </div>
  </div>
</div>
